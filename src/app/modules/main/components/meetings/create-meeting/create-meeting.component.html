
<app-bread-crumb [breadcrumbs]="breadcrumbs"></app-bread-crumb>

<div *ngIf="form" class="new-meeting-container  h-full">
  <div class="header p-4">اجتماع جديد</div>
  <form (submit)="submit()" action="" class="p-4" [formGroup]="form">
    <div class="input-field flex justify-between mb-3">
      <label> عنوان الاجتماع </label>
      <input type="text" class="address-input" formControlName="title" />
    </div>
    <div class="input-field flex justify-between mb-3">
      <label>مكان الاجتماع </label>
      <input formControlName="meeting_address" type="text" class="address-input" />
    </div>
    <!-- Committees Dropdown -->

    <!-- ignore it for now  -->
    <!-- <div class="input-field flex justify-between mb-3">
      <span> اللجان </span>

      <mat-form-field class="custom-dropdown ">
        <mat-select formControlName="members_ids" multiple> </mat-select>
      </mat-form-field>

    </div> -->


    <!-- Members Dropdown -->
    <div class="input-field flex justify-between mb-3">
      <label> الأعضاء </label>

      <div class="ng-select ">
        <ng-select formControlName="members_ids" [multiple] ="true">
          <ng-option *ngFor="let user of users$ | async" [value]="user.id"> {{user?.name}}</ng-option>
        </ng-select>
      </div>

    </div>

    <!-- Programs Dropdown -->
    <div class="input-field flex justify-between mb-3">
      <label> البرامج </label>

      <div class="ng-select ">
        <ng-select [multiple]="true" formControlName="projects_ids">
          <ng-option *ngFor="let project of projects$ | async" [value]="project.id"> {{project.title}}</ng-option>
        </ng-select>
      </div>
    </div>


    <div class="start-date-wrapper flex gap-4 mb-3">
      <div class="start-date-input flex items-center gap-2 w-1/2">
        <label for="">تاريخ بداية الاجتماع</label>
        <input class="flex-grow" matInput formControlName="meeting_date" (click)="setTodayDate()"
          [matDatepicker]="picker" />
        <mat-datepicker-toggle matIconSuffix [for]="picker" (click)="setTodayDate()"></mat-datepicker-toggle>
        <mat-datepicker #picker></mat-datepicker>
      </div>
      <div class="meeting-time-input flex items-center gap-2 w-1/2">
        <label for="">وقت بداية الاجتماع</label>
        <p-datepicker inputId="calendar-timeonly" formControlName="meeting_time" [timeOnly]="true"
           class="flex-grow" />
        <i class="bi bi-clock" style="font-size: 20px ;margin: 0 15px;"></i>
      </div>
    </div>

    <textarea name="" id="" class="details" placeholder="التفاصيل" formControlName="content"></textarea>
    <div  class="uploaded-files input-field mb-3">
      <label class="title">ملفات مرفقة</label>

      <app-files-upload  [control]="filesControl"></app-files-upload>
    </div>

    <div class="input-field mb-9">
      تذكير قبل ب
      <select class="reminder" formControlName="reminder_time">
        <option value="0">بدون تذكير</option>
        <option *ngFor="let time of times" value="{{time}}">{{time}}</option>
      </select>
      دقيقة
    </div>

    <button class="add-btn" [disabled]="form.invalid || isUpdating" [class.loading-btn]="isUpdating">
      <span *ngIf="id">تعديل اجتماع</span>
      <span *ngIf="!id"> اضافة اجتماع</span>

    </button>
  </form>
</div>